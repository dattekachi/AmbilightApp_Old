Improved performance and added new features